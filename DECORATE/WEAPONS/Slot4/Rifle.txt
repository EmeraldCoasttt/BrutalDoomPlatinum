ACTOR Rifle : BrutalWeapon
{
	Weapon.AmmoGive1 30
	Weapon.SlotNumber 4
	Weapon.SlotPriority 1
	Weapon.SelectionOrder 2500
	Weapon.AmmoType1 "Clip2"
	Weapon.AmmoType2 "AmmoRocket"
	BrutalWeapon.MagCapacity 30
	Obituary "%o was shot down by %k's assault rifle."
	Inventory.PickupSound "CLIPIN"
	Inventory.Pickupmessage "You got the Assault Rifle! (Slot 4)"
	Tag "$BDPRIFLE"
	Scale 0.8
	Inventory.AltHUDIcon "RIFLA0"
	States
	{
	SprintOverlay:
		RIFG JKLM 1 A_WeaponReadyDX(WRF_ALLOWRELOAD,FALSE,FALSE)
	KeepSprinting:
		RIFG N 1 A_weaponreadyDX(WRF_ALLOWRELOAD,FALSE,FALSE)
		TNT1 A 0 A_keepsprinting
	Returnfromsprint:
		RIFG MLKJ 1 A_weaponreadyDX(WRF_ALLOWRELOAD,FALSE,FALSE)
		Goto Ready
	GrenadeThrowFlash:
		RIFG FGHI 1
		TNT1 A 24
		RIFG IHGF 1//32 in total
		stop
	Fidget:
		2IFR POB 1 A_WeaponReadyDX(0,false,false)
	FidgetSpam:
		2IFR CDEFG 1 A_WeaponReadyDX(0,false,false)
		2IFR H 5 A_WeaponReadyDX(0,false,false)
		2IFR A 0 A_StartSound("Rifle/Bolt1", 5)
		2IFR IIJJJ 1 A_WeaponReadyDX(0,false,false)
	FidgetLoop:
		2IFR J 1 A_WeaponReadyDX(0,false,false)
		TNT1 A 0 A_PressingReload("FidgetLoop")
		2IFR A 0 A_StartSound("Rifle/Bolt2", 5)
		2IFR KKLM 1 A_WeaponReadyDX(0,false,false)
		TNT1 A 0 A_PressingReload("FidgetSpam")
		2IFR N 1 A_WeaponReadyDX(0,false,false)
		TNT1 A 0 A_PressingReload("FidgetSpam")
		2IFR N 1 A_WeaponReadyDX(0,false,false)
		TNT1 A 0 A_PressingReload("FidgetSpam")
		2IFR N 1 A_WeaponReadyDX(0,false,false)
		TNT1 A 0 A_PressingReload("FidgetSpam")
		2IFR N 1 A_WeaponReadyDX(0,false,false)
		TNT1 A 0 A_PressingReload("FidgetSpam")
		2IFR NOP 1 A_WeaponReadyDX(0,false,false)
		Goto Ready
	KickingFlash:
		RIFG JKLMNNNNNNNNMLKJ 1
		Goto Ready
	AirKickingFlash:
		RIFG JKLMNNNNNNNNNNMLKJ 1 //18
		Goto Ready
	 SlideKickingStart:
		RIFG JKLM 1
		RIFG NNNNNNNNNNNNNNNNNN 1 //18
		RIFG MLKJ 1
		Goto Ready
	FuckYouFlash:
		RIFG JKLMNNNNNNNNNNNNNNNNNNNNNNMLKJ 1//30 total
		stop
	Ready:
		RIFG A 1 A_WeaponReadyDX(WRF_ALLOWRELOAD)
		TNT1 A 0 A_AutoReloadMag
		TNT1 A 0 A_AutoReload("RifleGrenade","AmmoRocket","ReloadGrenade",TRUE)
		Loop
	Deselect:
		RIFG FGHI 1
		TNT1 A 1
		TNT1 A 0 A_Lower
		Wait
	Select:
		TNT1 A 1 {A_SetCrosshairDX("CGUNRet", 1000,0.7); A_GunSlingerMag(1);}
		TNT1 A 0 A_StartSound("CLIPIN")
		RIFG IHGF 1 A_WeaponReady(WRF_NOFIRE)
		Goto Ready
	Fire:
		RIFG A 0 A_CheckIfMag
		RIFF D 0 A_Jump(128,2)
		RIFF A 0
		RIFF "#" 1 Bright
		{
			A_FireBullets (2.5, 2.5, -1, 20, "HitPuff", FBF_NORANDOM,0,"decorativetracer",-12);
			A_FireParticles(0,1,0,-4);
			A_StartSound("weapons/rifle", 1);
			A_StartSound("FARRIF", 6);
			A_AlertMonstersDX;
			A_ZoomFactor(0.98);
			A_QuadSound;
			A_GunLight;
			A_TakeMag;
		}
		TNT1 A 0 A_WeaponOffset(random(-1,1),32+random(0,1) )
		TNT1 A 0 A_SetPitch(pitch-0.5, SPF_INTERPOLATE)
		RIFF B 1 A_FireProjectile("RifleCaseSpawnVersion2",5,0,6,-14)
		TNT1 A 0 A_SetPitch(pitch-1.0, SPF_INTERPOLATE)
		RIFF C 1 A_ZoomFactor(1.0)
		TNT1 A 0 A_SetPitch(pitch+1.0, SPF_INTERPOLATE)
		RIFG A 1 A_WeaponOffset(0,32)
		TNT1 A 0 A_Refire
		Goto Ready
	AltFire:
		TNT1 A 0 A_CheckIfAmmo("RifleGrenade",1)
		RIFF E 1 BRIGHT
		{
			A_FireBullets (0, 0, -1, 200, "GrenadePuff", FBF_NORANDOM,0,"RifleGrenadeTracer",-12);
			A_SetPitch(pitch-8, SPF_INTERPOLATE);
			A_FireParticles(0,1,0,-4);
			A_StartSound("Weapons/Firegrenade", 1);
			A_AlertMonstersDX;
			A_ZoomFactor(0.98);
			A_QuadSound;
			A_GunLight;
			A_TakeAmmo("RifleGrenade");
		}
		TNT1 A 0 A_ZoomFactor(1.0)
		RIFF FGHI 1 A_SetPitch(pitch+2, SPF_INTERPOLATE)
		RIFG A 15
	//Auto reload, as it's a single shot weapon
	ReloadGrenade:
		TNT1 A 0 A_CheckIfAmmo("AmmoRocket",1,"GrenadeNoAmmo")
		RIGL ABCDEFGGHH 1
		HBUS A 0 A_StartSound("Rifle/Grenade1", 5)
		TNT1 A 0 A_SpawnItemEX("GrenadeCasing",2,0,40,0,0,-4,0)
		RIGL IJJJJKLMNOPPPPQRSTUUVVV 1
		HBUS A 0 A_StartSound("Weapons/GrenadeLoad", 5)
		TNT1 A 0 A_Reload("RifleGrenade",1,"AmmoRocket")
		RIGL WXYYYYZZ 1
		RIG2 ABCDEE 1
		HBUS A 0 A_StartSound("Rifle/Grenade2", 5)
		RIGL IHHHHGGFEDCBA 1
		Goto Ready
	NoAmmo:
		TNT1 A 0 A_StartSound("weapons/empty", 3)
	NoAmmo2:
		TNT1 A 0 A_AutoReloadMag
	GrenadeNoAmmo:
		RIFG A 1 A_WeaponReady(WRF_NOFIRE)
		TNT1 A 0 A_JumpIf(GetPressed(BT_RELOAD) || GetPressed(BT_ATTACK) || GetPressed(BT_ALTATTACK), "NoAmmo2")
		Goto Ready
	Reload:
		TNT1 A 0 A_StartSound("Relo1", 6)
		RIFR ABCDEFGG 1
		RIFR G 0 A_FireProjectile("EmptyClipSpawn",-5,0,8,-4)
		TNT1 A 0 A_DiscardMagazine(1)
		RIFR H 3
		RIFR IJKLMNNO 1
		RIFR A 0 A_StartSound("Relo2", 5)
		RIFR OONPQR 1
		TNT1 A 0 A_CheckIfMag(1,"ReloadEmpty")
		TNT1 A 0 A_reloadmag(1)
		RIFR STUU 1
		RIFR VVVWXYZ 1
		RIFR "[" 1
		RIFR B 1
		RIFR BA 1
		Goto Ready
	ReloadEmpty:
		TNT1 A 0 A_reloadmag(1)
		RIFR STUU 1
		RIFR VVVWXYZ 1
		RIFR "[" 1
		RIFR B 1
		2IFR ABCDEFG 1
		2IFR H 3
		TNT1 A 0 A_StartSound("Rifle/Bolt1", 5)
		2IFR IJJJ 1
		TNT1 A 0 A_StartSound("Rifle/Bolt2", 5)
		TNT1 A 0 A_TakeInventory("RifleReloadToken",1)
		2IFR KKLMNOP 1
		Goto Ready
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_jump(256,"spawn1","spawn2","spawn3")
		Loop
	Spawn1:
		RIFL C 1 A_jumpifinventory("AmmoTaken",1,"SpawnNoAmmo")
		Loop
	Spawn2:
		RIFL D 1 A_jumpifinventory("AmmoTaken",1,"SpawnNoAmmo")
		Loop
	Spawn3:
		RIFL E 1 A_jumpifinventory("AmmoTaken",1,"SpawnNoAmmo")
		Loop
	SpawnNoAmmo:
		RIFL A -1
		Loop

	/*//AltFire:
		RIFG A 0
		//RIFG A 0 ACS_NamedExecuteAlways("HoldAim")
		RIFG A 0 A_Giveinventory("GoSpecial",1)
		//RIFG A 0 A_JumpIfInventory("Zoomed",1,"NoAim")
		RIFG A 0 A_Giveinventory("Zoomed",1)
		RIFG A 0 A_ZoomFactor(2.0)
		RIFG A 0 A_Giveinventory("ADSmode",1)
		RIFG A 0 A_GiveInventory("ZoomHold",1)
		//TNT1 A 0 A_SetCrosshair(41)
		SMGG A 0 A_StartSound("ADSIN")
		RIFZ ABC 1
		RIFZ D 2
		StillAiming:
		TNT1 A 0 //A_WeaponZoom
		Goto Aim2
		Aim1:
			SMGG A 0 A_ZoomFactor(2.0)
			TNT1 A 0 A_jumpifinventory("firedprimary",1,"Fire2")
			RIFZ D 1 A_jumpifinventory("firedprimary",1,"Fire2")
			
			
			TNT1 A 0 A_jumpifinventory("reloading",1,"reload")
			TNT1 A 0 A_jumpifinventory("firedprimary",1,"Fire2")
			TNT1 A 0 A_jumpifinventory("firedsecondary",1,"Aim1")
			Goto noaim
		Aim2:
			SMGG A 0 A_ZoomFactor(2.0)
			TNT1 A 0 A_jumpifinventory("firedprimary",1,"Fire2")
			RIFZ D 1 A_jumpifinventory("firedprimary",1,"Fire2")
			TNT1 A 0 A_jumpifinventory("reloading",1,"reload")
			TNT1 A 0 A_jumpifinventory("firedprimary",1,"Fire2")
			TNT1 A 0 A_jumpifinventory("firedsecondary",1,"NoAim")
			LOOP
		
		
	NoAim:
		RIFG A 0
		RIFG A 0 A_Takeinventory("Zoomed",1)
		RIFG A 0 A_Takeinventory("ZoomHold",1)
		RIFG A 0 A_ZoomFactor(1.0)
		RIFG A 0 A_Takeinventory("ADSmode",1)
		RIFG A 0 A_TakeInventory("Fire2Activate",1)
		RIFG A 0 A_Takeinventory("PressedTwice",1)
		RIFG A 0 A_TakeInventory("PressedOnce",1)
		RIFG A 0 {if(GetCVAR("bd_SmartCrosshairs") == 1){A_SetCrosshair(GetCVAR("RifleCrosshair"));}else{A_SetCrosshair(0);}}
		SMGG A 0 A_StartSound("ADSOUT")
		RIFZ BA 1
		Goto Ready
	 Fire2:
	RIFG A 0 A_CheckIfAmmo("RifleAmmo")
		TNT1 AA 0
		RIFG A 0 A_AlertMonstersDX
		RIFF A 0 A_FireProjectile("DistantFireSoundRifle", random(-1,1), 0, 0, -12, 0, random(-1,1))
		RIFG A 0 A_TakeAmmo("DoubleRifleAmmo",1)
		RIFG A 0 A_TakeAmmo("RifleAmmo",1)
		RIFG A 0 A_StartSound("weapons/rifle", 1)
		"----" A 0 { If(GetCVAR("BD_MagGoClicky")==1) { if(CountInv("RifleAmmo")<=8) { A_StartSound("MagClick", 7); }}}
		RIFG A 0 
		//RIFF A 0 A_FireProjectile("GunFireSmoke", 0, 0, 0, 0, 0, 0)
		TNT1 A 0 A_GunLight
		RIFG A 0 A_SpawnItemEx("PlayerMuzzle1",30,0,45)
		RIFG A 0 A_ZoomFactor(1.9)
		RIFZ E 1 BRIGHT A_FireBullets (1.5, 1.5, -1, 20, "HitPuff", FBF_NORANDOM,8192,"decorativetracer",-4)
		//	RI2F A 0 BRIGHT A_FireProjectile("DecorativeTracer", 0, 0, 0, 0)
	//	RIFG A 0 A_Takeinventory("RifleAmmo",1)
		"####" A 0 A_QuadSound
		RIFG A 0 A_ZoomFactor(2.0)
		RIFZ F 1 
		RIFG A 0 A_FireProjectile("RifleCaseSpawnVersion2",1,0,8,0)
		RIFZ G 1
		RIFG A 0
		RIFZ H 1
		RIFG A 0
		RIFZ D 1 A_jumpifinventory("firedprimary",1,"Fire2")
		TNT1 A 0 //A_WeaponZoom2
	SelectFromDual:
		TNT1 AAAAAAAAAAAAAAA 0 A_Raise
		//TNT1 AA 1 A_JumpIfInventory("GoFatality", 1, "Steady")
		//RIFG A 0 A_StartSound("CLIPIN")
		RIFG A 0 A_Takeinventory("BDWeaponACtion",1)
		XXXX X 0 A_StartSound("foley/RifleInspectMisc",10)
		DURI "]\[" 1
		DURI ZYXWVUT 1
		RIFG A 0 A_Takeinventory("StartDualWield",1)
		TNT1 A 0 A_TakeInventory("SwitchingDualModes",1)
		TNT1 AAAA 0
		Goto Ready
	//DualWield:
		RIFG A 1
		RIFG A 0 A_Takeinventory("StartDualWield",1)
		RIFG A 0 A_startsound("dryfire",2)
		//TNT1 A 0 A_JumpIfInventory("UseBashInstead",1,"Bash")
		//RIFG A 0 A_JumpIfInventory("IsTacticalClass", 1, "NoDual")//Tactical mode cant dual
		RIFG A 0 A_JumpIfInventory("RifleRPM", 1, "ToggleRPM")
		RIFG A 0 A_Print("1050 RPM",1)
		RIFG A 0 A_giveinventory("RifleRPM",1)
		Goto Ready
	ToggleRPM:
		RIFG A 0 A_Print("700 RPM",1)
		RIFG A 0 A_Takeinventory("RifleRPM",1)
		Goto Ready
	
	NoDual:
		RIFG A 1
		TNT1 A 0 A_Print("You can't dual wield in Tactical Mode.",2)
		Goto Ready
		
	 GetDual:	
		RIFG A 0 A_Takeinventory("Zoomed",1)
		RIFG A 0 A_Takeinventory("ADSmode",1)
		RIFG A 0 A_TakeInventory("TossGrenade", 1)
		RIFG A 0 A_TakeInventory("Kicking",1)
		RIFG A 0 A_TakeInventory("Taunting",1)
		RIFG A 0 A_TakeInventory("Reloading",1)
		RIFG A 0 A_TakeInventory("Unloading",1)
		RIFG A 0 A_TakeInventory("Salute1", 1)
		RIFG A 0 A_TakeInventory("Salute2", 1)
		TNT1 A 0 A_GiveInventory("SwitchingDualModes", 1)
		TNT1 A 0 A_GiveInventory("RememberDualRifle", 1)
		RIFG A 0 A_ZoomFactor(1.0)
		RIFG A 0 A_SelectWEapon("DualRifles")
		Goto Ready*/
	}
}

Actor Zoomed : Inventory
{
inventory.maxamount 1
}

ACTOR RifleGrenade : Ammo
{
	Inventory.Amount 0
	Inventory.MaxAmount 1
	Ammo.BackpackAmount 0
	Ammo.BackpackMaxAmount 1
}

ACTOR MeatshieldGunAmmo : Ammo
{
	Inventory.Amount 0
	Inventory.MaxAmount 30
	Ammo.BackpackAmount 0
	Ammo.BackpackMaxAmount 30
}

ACTOR MeatAmmo : Ammo
{
	Inventory.Amount 0
	Inventory.MaxAmount 100
	Ammo.BackpackAmount 0
	Ammo.BackpackMaxAmount 100
}

ACTOR swapRifleSpecial : Inventory {Inventory.MaxAmount 1}
ACTOR UseBashInstead : Inventory {Inventory.MaxAmount 1}

ACTOR RifleStainedGreen : Inventory {Inventory.MaxAmount 1}
ACTOR RifleStainedBlue : Inventory {Inventory.MaxAmount 1}
ACTOR RifleStainedRed : Inventory {Inventory.MaxAmount 1}