class RailgunTrail : VisualThinker
{
	override void PostBeginPlay()
	{
		Super.PostBeginPlay();
		texture = TexMan.CheckForTexture('SPKOB0');
		scale = (0.3,0.3);
		alpha = 1.0;
		flags = SPF_FULLBRIGHT;
		SetRenderStyle(STYLE_Add);
	}
	
	override void Tick()
	{
		scale -= (0.01,0.01);
		Super.Tick();
		if(scale.x <= 0)
		{
			Destroy();
		}
	}
}

class BDPRailgun : BDPWeaponBase
{
	bool emptyChamber;
	bool steam;
	
	Default
	{
		Weapon.AmmoGive 40;
		Weapon.AmmoType "BDPCell";
		BDPWeaponBase.MagCapacity 5;
		BDPWeaponBase.MagConversion (1,10);
		Obituary "%o was pierced by %k's Railgun.";
		Inventory.PickupSound "RAILINSR";
		Inventory.Pickupmessage "You got the Railgun! (Slot 6)";
		DamageType "Railgun";
		Weapon.SlotNumber 6;
		Weapon.SlotPriority 2;
		Weapon.SelectionOrder 1550;
		Inventory.AltHUDIcon "SRCGA0";
		Tag "$BDPRAILGUN";
	}
	
	Action void a_spawnhologram()
	{
		A_radiusgive("KillHologram",10000,RGF_MONSTERS | RGF_NOSIGHT,1,"HoloPlayer");
		FLineTraceData lasersight;
				LineTrace(angle, 4096, pitch, TRF_SOLIDACTORS|TRF_THRUHITSCAN, offsetz: player.viewz - pos.z, data: lasersight);
				vector3 targetpos = lasersight.HitLocation;
				if (lasersight.HitLine)
				{
					vector2 wallnormal = (-lasersight.HitLine.delta.y,lasersight.HitLine.delta.x).unit();
					if (!lasersight.LineSide)
					wallnormal *= -1;
					targetpos += (wallnormal * 18);
				}
				if (lasersight.hittype == trace_hitceiling)
				{
					targetpos.z -= 13;
				}
				Let HoloTarget = Spawn("Holotarget",targetpos);
				Let HoloPlayer = Spawn("Holoplayer",pos);
				If(HoloTarget && HoloPlayer)
				{
					HoloPlayer.angle = angle;
					HoloPlayer.Tracer = Holotarget;
					HoloPlayer.Translation = Invoker.owner.Translation;
				}
				
		
	}
	
	Action void a_firenurailgun()
	{
		FLineTraceData railspawn;
				LineTrace(angle, 8192, pitch, TRF_NOSKY | TRF_THRUACTORS, player.viewz - player.mo.pos.z - 5, data: railspawn);
				if (railspawn.HitType != TRACE_HitNone)
				{
				vector3 targetpos = railspawn.HitLocation;
			if (railspawn.HitLine)
				{
					vector2 wallnormal = (-railspawn.HitLine.delta.y,railspawn.HitLine.delta.x).unit();
					if (!railspawn.LineSide)
					wallnormal *= -1;
					targetpos += (wallnormal * 3);
				}
					actor beam = Spawn("railgunrail", targetpos);
		  
					if (beam)
					{
						beam.angle = angle;
						beam.pitch = pitch;
					}
					for (int i = 0; i < 20; i++)
					{
						actor rico = Spawn("ricochet", targetpos);
			  
						if (rico)
						{
							rico.angle = angle + 180;
						}
					}
				}
				
				Vector3 trailpos = (pos.x - railspawn.HitLocation.x, pos.y - railspawn.HitLocation.y, pos.z + player.viewz - player.mo.pos.z - 5 - railspawn.HitLocation.z);
				FSpawnParticleParams trail;
				for(int i = railspawn.distance; i > 0; i -= 2)
				{
					let trail = Level.SpawnVisualThinker("RailgunTrail");
					trail.pos = railspawn.HitLocation + trailpos * (i/railspawn.distance);
					trail.pos += (frandom(1,-1),frandom(1,-1),frandom(1,-1));
				}
				
				invoker.emptyChamber = true;
				
				A_Fireprojectile("RailgunProjectile", 0, 0, 0, 0);
				A_alertmonstersDX(500);
				A_RailAttack(450, 0, 0, "", "", 0, 0, "RailgunPuff2");
				A_Fireprojectile ("PlasmaSmoke", 0, 0, 0, 2);
				A_StartSound("RAILF01", 1);
				A_TakeMag();
				A_WeaponRecoil(6);
				A_QuadSound();
				if(invoker.owner.pos.z <= invoker.owner.floorz)
				{
					A_Recoil3d(3);
				}
				else
				{
					A_Recoil3d(20);
				}
	
	}
	States
	{
	Grenade: //30
		TNT1 A 0 A_EndAim();
		RAIS ABCD 1;
		TNT1 A 22;
		RAIS DCBA 1;
		Goto Ready;
	Kick: //18
		RAIK ABCD 1;
		RAIK E 10;
		RAIK DCBA 1;
		Goto Ready;
	SlideKick: //25
		RAIK ABCD 1;
		RAIK E 17;
		RAIK DCBA 1;
		Goto Ready;
	Taunt: //30
		TNT1 A 0 A_EndAim();
		RAIK ABCD 1;
		RAIK E 22;
		RAIK DCBA 1;
		Goto Ready;
	Sprint:
		RAIK ABCD 1 A_SetSprites("TNT1A0",1);
	SprintLoop:
		RAIK E 1 A_SetSprites("TNT1A0",1);
		Loop;
	SprintEnd:
		RAIK DCBA 1 A_SetSprites("TNT1A0",1);
		Stop;
		Select:
			TNT1 A 1 {A_SetCrosshairDX("RAILRet", 10000); A_GunSlingerMag();}
			TNT1 A 0 A_startSound("RAILINSR",1);
			RAIS DCBA 1 A_WeaponReady(WRF_NOFIRE);
			Goto Ready;
		Deselect: 
			TNT1 A 0 A_EndAim();
			RAIS ABCD 1;
			TNT1 A 0 A_StopSOund(1);
			TNT1 A 0 A_StopSOund(2);
			TNT1 A 0 A_StopSOund(6);
			TNT1 A 1;
			TNT1 A 0 A_Lower();
			Wait;
		Ready:
			TNT1 A 0 A_SetCrosshairDX("RAILRet", 10000);
			RAIL A 1 A_weaponreadyDX(WRF_ALLOWRELOAD);
			LOOP;

		Fidget:
			TNT1 A 0 A_EndAim();
			TNT1 A 0 A_overlay(-5,"pumpinghandlol");
			RAIL FGHI 1;
			
			RAIL JKLMNNOOO 1 A_WeaponReadyDX(0,false);
			TNT1 A 0 A_overlay(-5,"pumpinghandlol2");
			RAIL OOOO 1 A_WeaponReadyDX(0,false);
		FidgetSpam:
			TNT1 A 0 A_StartSound("RAILMAG2", 5);
			RAIL PR 1 A_WeaponReadyDX(0,false);
			RAIL TWWVUUUUUUUU 1 A_WeaponReadyDX(0,false);
		FidgetLoop:
			RAIL U 1 A_WeaponReadyDX(0,false);
			TNT1 A 0 A_PressingReload("FidgetLoop");
			TNT1 A 0 A_StartSound("RAILINSR", 5);
			RAIL UUUUUTTSRQP 1 A_WeaponReadyDX(0,false);
			TNT1 A 0 A_JumpIf(LastPressed(BT_RELOAD,10), "FidgetSpam");
			TNT1 A 0 A_overlay(-5,"pumpinghandlol2reverse");
			RAIL OOOOONMLKJ 1 A_WeaponReadyDX(0,false);
			TNT1 A 0 A_overlay(-5,"pumpinghandlolreverse");
			RAIL IHGF 1 A_WeaponReadyDX(0,false);
			Goto ready;

		Fire:
			TNT1 A 0 A_JumpIf(invoker.emptyChamber,"Pumping");
			TNT1 A 0 A_CheckIfMag();
			TNT1 AAAAAAAAAA 0 A_Fireprojectile ("BluePlasmaParticleWeapon", random(-60,60), 0, -1, -3, 0, random(-6,70));
			RAIL A 0 
			{
				A_overlay(-5,"DoNothing");
				A_firenurailgun();
				A_zoomfactor(0.7);
			}
			TNT1 A 0 A_GunLight();
			RAIF A 1;
			TNT1 A 0 A_GunLight();
			TNT1 A 0 A_zoomfactor(1.0);
			RAIF BCDEFG 1;
			
			RAIL BCDEBCDEBCDEBCDE 1 A_WeaponReady(WRF_NOFIRE| WRF_NOBOB);
			TNT1 A 0 A_CheckIfMag(1,"Ready");
			TNT1 A 0 A_JumpIf(GetCvar("ManualShotgunPump")==1,"Ready");
		Pumping:
			TNT1 A 0 A_overlay(-5,"pumpinghandlol");
			RAIL FGHI 1;
			
			RAIL JKLMNNOOO 1;
			TNT1 A 0 A_overlay(-5,"pumpinghandlol2");
			RAIL OOOO 1;
			TNT1 A 0 A_StartSound("RAILMAG2", 5);
			RAIL PR 1;
			TNT1 A 0 
			{
				If(invoker.emptyChamber)
				{
					A_startsound("Railgun/Eject",2);
					A_FireProjectile("RailCaseSpawn",0,0,0,0,0,0);
					if(invoker.mag < 1)
					{
						takeinventory("railchambered",1);
					}
				}
			}
			RAIL TWWVUUUUUUUUUUUUUUU 1
			{
				If(invoker.emptyChamber)
				{
					A_FireProjectileDX("Smallgunbarrelsmoke",frandom(-35,-45),frandom(-20,-30));
				}
			}
			TNT1 A 0
			{
				invoker.emptyChamber = false;
				if(invoker.mag < 1)
				{
					return resolvestate("ReloadFromPump");
				}
				else
				{
					return resolvestate(null);
				}
			}
			TNT1 A 0 A_AutoReloadMag(1,"ReloadFromPump");
			TNT1 A 0 {if(invoker.mag < 5 && countinv("BDPCell") > 9) {A_PressingReload("ReloadFromPump");}}
			Goto FinishPump2;
		FinishPump:
			RAIL WWVV 1;
		FinishPump2:
			TNT1 A 0 A_StartSound("RAILINSR", 5);
			RAIL UUUUUTTSRQP 1;
			TNT1 A 0 A_overlay(-5,"pumpinghandlol2reverse");
			RAIL OOOOONMLKJ 1;
			TNT1 A 0 A_overlay(-5,"pumpinghandlolreverse");
			RAIL IHGF 1;
			TNT1 A 0 A_ReFireDX();
			Goto ready;
		ReloadFromPump:
			TNT1 A 0 
			{
			takeinventory("reloading",1);
			A_overlay(-5,"ReloadingHand1");
			}
			RAIL X 4;
		ReloadFromPumpInsertShells:
			TNT1 A 0 A_WeaponReady(WRF_NOFIRE| WRF_NOBOB);
			TNT1 A 0 A_overlay(-5,"ReloadingHand2");
			RAIL X 7 A_WeaponReady(WRF_NOBOB);
			RAIR AB 1 A_WeaponReady(WRF_NOBOB);
			TNT1 A 0 A_ReloadMag(0,true);
			RAIR BA 1 A_WeaponReady(WRF_NOBOB);
			RAIL X 4 A_WeaponReady(WRF_NOBOB);
			TNT1 A 0
			{
				If(invoker.mag < 5 && Countinv("BDPCell") > 9)
					{
						Return resolvestate("ReloadFromPumpInsertShells");
					}
				Else
					{
						Return resolvestate(null);
					}
			}
			TNT1 A 0 A_overlay(-5,"ReloadingHand3");
			RAIL X 4;
			Goto FinishPump;
		
		
		DoReload:
			TNT1 A 0 A_EndAim();
			TNT1 A 0 A_AutoReloadMag(1,"Pumping",true);
			TNT1 A 0 A_overlay(-5,"pumpinghandlol");
			RAIL FGHIJKLMNNOOO 1;
		ReloadInsertShells:
			TNT1 A 0 A_WeaponReady(WRF_NOFIRE| WRF_NOBOB);
			TNT1 A 0 A_WeaponReady(WRF_NOBOB);
			TNT1 A 0 A_overlay(-5,"ReloadingHand2");
			RAIL O 7 A_WeaponReady(WRF_NOBOB);
			RAIR CD 1 A_WeaponReady(WRF_NOBOB);
			TNT1 A 0 A_ReloadMag(0,true);
			RAIR DC 1 A_WeaponReady(WRF_NOBOB);
			RAIL O 4 A_WeaponReady(WRF_NOBOB);
			TNT1 A 0
			{
				If(invoker.mag < 5 && Countinv("BDPCell") > 9)
					{
						Return resolvestate("ReloadInsertShells");
					}
				Else
					{
						Return resolvestate(null);
					}
			}
			RAIL OOOOONMLKJ 1;
			TNT1 A 0 A_overlay(-5,"pumpinghandlolreverse");
			RAIL IHGF 1;
			Goto ready;
			
	NoAmmo:
		TNT1 A 0 A_Dryfire("RAILDRY", 1);
		TNT1 A 0 A_JumpIf(invoker.aimMode > 0,"Aim");
		Goto Ready;
	AltFire:
		TNT1 A 0 {
			A_overlay(-5,"DoNothing");
			A_StartAim(3.0);
			A_SetCrosshairDX("Null");
		}
		RAIZ ABCDEF 1;
	Aim:
		TNT1 A 0 A_HandleScope(3.0,9.0,"BEP","BEPBEP");
		SNIP C 1 Bright A_WeaponReadyDX(WRF_ALLOWRELOAD);
		Loop;
	AimEnd:
		TNT1 A 0
		{
			A_StartSound("ADSOUT");
			if(invoker.scopeZoom == true) A_ZoomFactor(3.0,ZOOM_INSTANT);
			A_ZoomFactor(1.0);
		}
		RAIZ FE 1;
		TNT1 A 0 A_SetCrosshairDX("RAILRet", 10000);
		RAIZ DCBA 1;
		TNT1 A 0 A_EndAim;
		Goto Ready;
	FireAim:
		TNT1 A 0 A_CheckIfMag();
		SNIP C 30 Bright
		{
			A_firenurailgun();
			A_GunLight();
		}
		TNT1 A 0 A_AutoReloadMag();
		TNT1 A 0 A_CheckIfMag(1,"Aim");
		TNT1 A 0 A_JumpIf(GetCvar("ManualShotgunPump")==1,"Ready");
	FireAimCont:
		TNT1 A 0 A_StartSound("RAILMAG2", 5);
		SNIP CC 1 BRIGHT;
		TNT1 A 0 {A_startsound("Railgun/Eject",2); A_FireProjectile("RailCaseSpawn",0,0,0,0,0,0);}
		SNIP CCCCCCCCCCCCCCCCCCC 1 BRIGHT A_FireProjectileDX("Smallgunbarrelsmoke",frandom(-35,-45),frandom(-20,-30));
		TNT1 A 0 {invoker.emptyChamber = false;}
		SNIP CCCC 1 BRIGHT;
		TNT1 A 0 A_StartSound("RAILINSR", 5);
		SNIP CCCCCCCCCC 1 BRIGHT;
		TNT1 A 0 A_RefireDX("FireAim");
		Goto Aim;
	Pumpinghandlol:
		TNT1 A 0 A_StartSound("foley/ShotgunReloadRaise", 6);
		RAIH ABCD 1;
		STOP;
	Pumpinghandlol2:
		RAIH IHFE 1;
		STOP;
	Pumpinghandlolreverse:
		TNT1 A 0 A_StartSound("foley/ShotgunReloadLower", 6);
		RAIH DCBA 1;
		STOP;
	Pumpinghandlol2reverse:
		RAIH FHI 1;
		STOP;
	ReloadingHand1:
		RAIH JKLM 1;
		Stop;
	ReloadingHand3:
		RAIH MLKJ 1;
		STOP;
	ReloadingHand2:
		TNT1 A 5;
		TNT1 A 0 A_startsound("Railgun/Insert",3,CHANF_OVERLAP);
		RAIH RQPONN 1;
		RAIH STUV 1;
		STOP;
	SpecialAction:
		TNT1 A 0 A_takeinventory("startdualwield",1);
		RAIL A 4;
		TNT1 A 0 A_jumpifinventory("holdingdual",1,"SlowHologram");
		TNT1 A 0
		{
			A_startsound("bepbep",4);
			A_SpawnHologram();
		}
		Goto Ready;
	SlowHologram:
		TNT1 A 0 A_startsound("PISTFOL5",10);
		RAIZ ABCD 1;
		TNT1 A 0 
		{
			A_startsound("BEP",4);
			A_SetCrosshairDX("Null");
		}
	HoldHologram:
		RAIZ D 1
		{
			FLineTraceData lasersight;
			LineTrace(angle, 4096, pitch, TRF_SOLIDACTORS|TRF_THRUHITSCAN, offsetz: player.viewz - pos.z, data: lasersight);
			vector3 targetpos = lasersight.HitLocation;
			if (lasersight.HitLine)
			{
				vector2 wallnormal = (-lasersight.HitLine.delta.y,lasersight.HitLine.delta.x).unit();
				if (!lasersight.LineSide)
				wallnormal *= -1;
				targetpos += (wallnormal * 18);
			}
			if (lasersight.hittype == trace_hitceiling)
			{
				targetpos.z -= 13;
			}
			if (lasersight.hittype == trace_hitfloor)
			{
				targetpos.z += 13;
			}
			Spawn("HoloLaser",targetpos);
		}
		TNT1 A 0 A_JumpIf(player.cmd.buttons & BT_USER3,"HoldHologram");
		TNT1 A 0
		{
			A_startsound("bepbep",4);
			A_SpawnHologram();
			A_startsound("PISTFOL5",10);
			A_SetCrosshairDX("RAILRet", 10000);
		}
		RAIZ DCBA 1;
		TNT1 A 0 A_takeinventory("startdualwield",1);
		Goto Ready;
	Spawn:
		SRCG A -1;
		Stop;
	}
}

CLASS RailgunRail : Actor
	{
	Default
		{
		Radius 1; 
		Height 1;
		+nogravity;
		+noclip;
		}
	States
		{
			Spawn:
				TNT1 AAA 0 A_SpawnItemEX("WhiteShockwave");

		TNT1 AAAA 0 A_spawnprojectile ("FireworkSFXType2", 2, 0, random (0, 360), 2, random (-10, -80));
		RAIL A 0 A_SpawnItemEx ("DetectFloorCrater",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0);
		RAIL A 0 A_SpawnItemEx ("DetectCeilCrater",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0);
		//RAIL A 0 A_spawnprojectile ("BluePlasmaFire", 0, 0, random (0, 360), 2, random (0, 360));
		TNT1 AAAAAAAAAA 0 A_spawnprojectile ("ExplosionParticleVeryFast", 0, 0, random (0, 360), 2, random (0, 360));
		 TNT1 AAAAAAAA 0 A_spawnprojectile ("ExplosionParticleHeavy", 5, 0, random (0, 360), 2, random (0, -180));
		TNT1 AAAAAAAAAA 0 A_spawnprojectile ("ExplosionParticleHeavy", 5, 0, random (0, 360), 2, random (0, 360));
		TNT1 AAAAAAAAA 0 A_spawnprojectile ("ExplosionParticleVeryFast", 5, 0, random (0, 360), 2, random (0, 360));
				MODL A 1 BRIGHT
				{
					Radius_Quake(3, 8, 0, 15, 0);
					A_startsound("BONECRACK",1);
					A_startsound("RICMET",2);
					A_spraydecal("RailLightning",36);
					Actor Core = spawn("railgunrail2",pos);
					core.angle = angle;
					core.pitch = pitch;
				}
				MODL A 35 BRIGHT
				{
					
				}
			TimeToFade:
				MODL A 1 BRIGHT
				{
					A_fadeout(0.01);
				}
				LOOP;
		}
	}

		CLASS RailgunRail2 : Actor
	{
	Default
		{
		Radius 1; 
		Height 1;
		+nogravity;
		+noclip;
		}
	States
		{
			Spawn:

				MODL A 225 NODELAY;
			Death:
				TNT1 AAAAAAAA 0
				{
				A_startsound("BONECRACK",1);
				//A_SpawnProjectile("NailgunGib1", random(-1,1), random(1,-1), random(135,225), 2, random (-50, 50));
				A_spawnitemex("Nailgungib1",frandom(-1,1),frandom(-3,-20),frandom(-1,1),frandom(-7,-3),frandom(-1,1),frandom(-10,10));
				A_spawnitemex("Nailgungib2",frandom(-1,1),frandom(-3,-20),frandom(-1,1),frandom(-7,-3),frandom(-1,1),frandom(-10,10));
				A_spawnitemex("Nailgungib3",frandom(-1,1),frandom(-3,-20),frandom(-1,1),frandom(-7,-3),frandom(-1,1),frandom(-10,10));
				//A_SpawnProjectile("NailgunGib2", random(-1,1), random(1,-1), random(135,225), 2, random (-50, 50));
				//A_SpawnProjectile("NailgunGib3", random(-1,1), random(1,-1), random(135,225), 2, random (-50, 50));
				}
				Stop;
				
		}
	}
	
CLASS HoloLaser: FastProjectile
{ 
	Default
	{
		Decal "None";
		Mass 0;
		Scale 0.2;
		Radius 1;
		Height 2;
		+NOBLOCKMAP;
		+NOGRAVITY;
		+BLOODLESSIMPACT;
		+ALWAYSPUFF;
		+PUFFONACTORS;
		+DONTSPLASH;
		+FORCEXYBILLBOARD;
		Renderstyle "Add";
		Alpha 0.8;
	}
	States
	{
	Spawn:
		LEYS RR 0;
		LEYS B 1 BRIGHT;
		Stop;
	}
}

class HoloTarget : FastProjectile
{ 
	Default
	{
		Decal "None";
		Mass 0;
		Scale 0.2;
		Radius 1;
		Height 2;
		+NOBLOCKMAP;
		+NOGRAVITY;
		+BLOODLESSIMPACT;
		+ALWAYSPUFF;
		+PUFFONACTORS;
		+DONTSPLASH;
		+FORCEXYBILLBOARD;
		Renderstyle "Add";
		Alpha 0.8;
	}
	Int HoloTimer;
	Override void tick()
	{
		Holotimer++;
		If ( holotimer >= 1000 )
		{
			Destroy();
		}
		Super.tick();
	}
	States
	{
	Spawn:
		TNT1 A 1;
		LOOP;
	}
}

class HoloPlayer : BDPNotMonster
{
	Default
	{
		Monster;
		-Solid;
		+notrigger;
		+noblockmonst;
		-Countkill;
		+NOBLOODDECALS;
		+BRIGHT;
		Renderstyle "Translucent";
		Alpha 0.75;
		Radius 16;
		Height 42;
		Health 200;
		Maxstepheight 666;
		Mass 99999;
		BloodType "HoloBlood";
	}
	Override void tick()
	{
		If ( !tracer || findinventory("KillHologram") )
		{
			A_fadeout(0.05);
		}
		Super.tick();
	}
	Action void A_HoloGramAlert()
	{
		BlockThingsIterator CheckFortracers = BlockThingsIterator.create(Self,1000); //256 can be whatever range around the actor.
		Actor CurrentActor;
		While (CheckFortracers.Next())
		{
			CurrentActor = CheckFortracers.Thing;
						
			//If the actor is a monster, has none of the specified item, the caller has a line of sight to the actor, and the actor is within 512 MU, then jump to the see state.
			//Itemname obviously has to be whatever item you want the actor to check that the possible target has none of, and the 512 map unit sight range can be changed to anything else.
			If (CurrentActor && CurrentActor.bismonster && currentactor.health > 0 && !currentactor.bfriendly && CheckSight(CurrentActor,SF_IGNOREWATERBOUNDARY) && currentactor.target && currentactor.target is "playerpawn" && !currentactor.findinventory("PissedArmor"))
			{
				Currentactor.target = self;
			}
			
		}
		
		A_alertmonsters(0,AMF_TARGETEMITTER);
	}
	States
	{
	Spawn:
		MARN AAABBBCCCBBB 1
		{
			A_facetracer();
			vector3 movepos = Vec3Angle(6,angle,0);
			If (checkmove(Vec2Angle(6,angle),PCM_NOACTORS))
			{
				setorigin(movepos,TRUE);
			}
			A_hologramAlert();
			If(tracer && distance2d(tracer) <= 32)
			{
				Return resolvestate("Spawn2");
			}
			
			Return resolvestate(null);
		}
		LOOP;
	Spawn2:
		TNT1 A 0 A_jump(30,"Twerk","TeaBag","Moves1","Moves2","Moves3","TPose");
		TNT1 A 0 A_jump(255,"Wave1","Wave2","Observe","Medkit");
	Wave1:
		MWAV IJK 1;
	Wave1Continue:
		MWAV LMNNML 3 A_hologramAlert();
		LOOP;
	Wave2:
		MWAV ABCD 3;
	Wave2Continue:
		MWAV EEEEEEEFFFFFFF 1 A_HoloGramAlert();
		LOOP;
	Observe:
		MR7S AAAAABBBBBACCCCCABBBBBAA 4 A_hologramalert();
		LOOP;
	MedKit:
		MR8S AAAAAAABBBBBBB 2 A_HoloGramAlert();
		LOOP;
	TeaBag:
		MARN AA 2 A_hologramalert();
		PLYC AA 2 A_hologramalert();
		LOOP;
	Twerk:
		TWRK CBA 2 A_hologramAlert();
		LOOP;
	Moves1:
		2AKE ABCDEFGHIJKLMOPQR 4 A_hologramAlert();
		LOOP;
	Moves2:
		3AKE ABCDEFGHIJKLMNO 4 A_hologramAlert();
		LOOP;
	Moves3:
		JAKE ABCDEFGHIJKLMNOP 4 A_hologramAlert();
		LOOP;
	TPose:
		TWRK D 4 A_hologramAlert();
		LOOP;
		
	Death:
		PLAY O 5;
		PLAY P 5 A_XScream();
		PLAY Q 5;
		PLAY RSTUV 5;
	
	Death2:
		PLAY W 1 A_fadeout(0.05);
		LOOP;
	}
}

class HoloBlood : Actor
{
	Default
	{
		+nogravity;
		+noblockmap;
	}
	States
	{
		Spawn:
			TNT1 AAA 0 NODELAY
			{
				A_spawnitemex("blueplasmaparticle",0,0,0,frandom(-5,5),frandom(-5,5),frandom(1,5));
				A_startsound("StickyGrenade/hit");
			}
			STOP;
	}
}

class RailgunProjectile : Actor
{
	int user_railangle;
	Default
	{
		Radius 2;
		Height 2;
		Speed 80;
		DamageFactor 0;
		DamageType 'Railgun';
		Projectile;
		+RANDOMIZE
		+MISSILE
		+FORCERADIUSDMG
		+THRUACTORS
		Species "Marines";
		Scale 1.0;
		
		renderstyle 'ADD';
		alpha 0.90;
		Scale 0.10;
		DeathSound "weapons/plasmax";
		SeeSound "None";
		Obituary "$OB_MPPLASMARIFLE";
		BounceCOunt 3;
	}
	States
	{
	DM:
		RAIL A 0;
		RAIL A 0 A_ChangeFLag("THRUSPECIES", 0);
		RAIL A 0 A_ChangeFLag("MTHRUSPECIES", 0);
		Goto Spawn1;
	Spawn:
		TNT1 A 0;
		RAIL A 0 A_FaceTarget;
		RAIL A 0 {user_railangle = angle;}
		RAIL A 0 A_SpawnItem("WhiteShockwave");
		RAIL A 0 ACS_NamedExecuteAlways("CheckIfDM", 0, 0, 0, 0);//Check if Coop
		TNT1 C 1 BRIGHT A_SpawnItem("WhiteShockwave");
	Spawn1:
		TNT1 C 1 BRIGHT A_SpawnItem("WhiteShockwave");
		RAIL A 0 A_SpawnItem("WhiteShockwave");
		RAIL A 0 A_CheckFloor("Death");
		RAIL A 0 A_CustomMissile ("OldschoolRocketSmokeTrail2", 2, 0, random (160, 210), 2, random (-30, 30));
		Loop;
	Death:
	Melee:
	Xdeath:
		TNT1 AAAA 0 A_SpawnItemEx("BluePlasmaParticleSpawner", 0, 0, 0, 0, 0, 0, 0, 128);
		TNT1 AA 0 A_SpawnItem("WhiteShockwave");
		TNT1 AAAAAAAAA 0 A_CustomMissile ("ExplosionParticleHeavy", 0, 0, random (0, 360), 2, random (0, 180));
		TNT1 AAAAAAAAAAAAAAAAAA 0 A_CustomMissile ("ExplosionParticleHeavy", 0, 0, random (0, 360), 2, random (0, 360));
		TNT1 AAAAAAAAA 0 A_CustomMissile ("ExplosionParticleVeryFast", 0, 0, random (0, 360), 2, random (0, 360));
		EXPL AAAAA 0 A_CustomMissile ("ExplosionSmokeFast22", 0, 0, random (0, 360), 2, random (0, 360));
		TNT1 AAAA 0 A_CustomMissile ("FireworkSFXType2", 2, 0, random (0, 360), 2, random (10, 80));
		RAIL A 0 A_SpawnItemEx ("DetectFloorCraterSmall",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0);
		RAIL A 0 A_SpawnItemEx ("DetectCeilCraterSmall",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0);
		RAIL A 0 A_CustomMissile ("BluePlasmaFire", 0, 0, random (0, 360), 2, random (0, 360));
		TNT1 AAAAA 0 A_CustomMissile ("BluePlasmaParticle", 0, 0, random (0, 360), 2, random (0, 360));
		TNT1 ABE 0 BRIGHT A_SpawnItem("BlueFlare" ,0);
		Death:
	Melee:
	Xdeath:
		Stop;
		Stop;
	}
}