class glasmaball : plasmaball replaces plasmaball
{
	Default {+FORCEXYBILLBOARD}
}

class BDPGrenadeLauncher : BDPWeaponBase
{
	bool chaosGrenades;
	
	Default
	{
		Weapon.AmmoGive 2;
		Weapon.AmmoType "BDPRocketAmmo";
		BDPWeaponBase.MagCapacity 1;
		Inventory.PickupSound "ROCKPKUP";
		Weapon.SlotNumber 5;
		Weapon.SlotPriority 2;
		Weapon.SelectionOrder 2700;
		Inventory.PickupMessage "You got the Grenade Launcher! (Slot 5)";
		+WEAPON.EXPLOSIVE
		Tag "$BDPGRENADE";
		Inventory.AltHUDIcon "GLAPA0";
	}
	States
	{
	Grenade: //30
		GLSA BCDE 1;
		TNT1 A 22;
		GLSA EDCB 1;
		Goto ReverseStrapIdle;
	Kick: //18
		GLAN BCDE 1;
		GLAN F 10;
		GLAN EDCB 1;
		Goto ReverseStrapIdle;
	SlideKick: //25
		GLAN BCDE 1;
		GLAN F 17;
		GLAN EDCB 1;
		Goto ReverseStrapIdle;
	Taunt: //30
		GLAN BCDE 1;
		GLAN F 22;
		GLAN EDCB 1;
		Goto ReverseStrapIdle;
	Sprint:
		GLAN BCDE 1 A_SetSprites("TNT1A0",1);
	SprintLoop:
		GLAN F 1 A_SetSprites("TNT1A0",1);
		Loop;
	SprintEnd:
		GLAN EDCB 1 A_SetSprites("TNT1A0",1);
		TNT1 A 0 {player.SetPSprite(1,resolvestate("ReverseStrapIdle"));}
		Stop;
	StrapIdle:
		SHTN A 0 A_JumpIfInventory("NoShotgunStrap",1,"Ready");
		GLR3 FEDCBAGHIJKLLLKJIHGABCDDDCBAGHIJJJIHG 1 A_WeaponReadyDX(WRF_ALLOWRELOAD,forcereload:true);
		Goto Ready;
	ReverseStrapIdle:
		SHTN A 0 A_JumpIfInventory("NoShotgunStrap",1,"Ready");
		GLR3 LKJIHGABCDDDCBAGHIJJJIHG 1 A_WeaponReadyDX(WRF_ALLOWRELOAD,forcereload:true);
		Goto Ready;
	Ready:
		GLAN A 1 A_WeaponReadyDX(WRF_ALLOWRELOAD,forcereload:true);
		Goto Ready;
	Deselect:
		GLSA ABCDE 1;
		TNT1 A 1;
		TNT1 A 0 ChangeAmmoIcon1("ROCKA0");
		TNT1 A 0 A_Lower();
		Wait;
	Select:
		TNT1 A 1
		{
			A_SetCrosshairDX("NADERet", 500);
			A_GunslingerMag();
			if(invoker.chaosGrenades)
				ChangeAmmoIcon1("ROCKE0");
		}
		TNT1 A 0 A_StartSound("ROCKPKUP");
		GLSA EDCBA 1 A_WeaponReady(WRF_NOFIRE);
		Goto StrapIdle;
	Fire:
		TNT1 A 0 A_CheckIfMag();
		GLAF A 1 Bright 
		{
			A_FireProjectileDX(invoker.chaosGrenades ? "StupidGrenade" : "GrenadeDetonates",rvel:false);
			A_FireProjectile("RedFlareSpawn",-5,0,0,0);
			A_FireProjectile("GrenadeMissileBreaksGlass", 0, 0, 0, 0);
			A_WeaponRecoil(10);
			A_FireParticles(7);
			A_StartSound("weapons/firegrenade", 1);
			A_AlertMonstersDX();
			A_ZoomFactor(0.98);
			A_QuadSound();
			A_GunLight();
			A_TakeMag(1,true);
			A_ZoomFactor(1.0);
			A_Recoil(1*cos(pitch));
			ThrustThingZ(0,momZ != 0 ? pitch/3 : pitch/4,0,1);
		}
		GLAF F 1 Bright A_GunLight();
		GLAF EDCB 1;
		GLR3 C 1;
		TNT1 A 0
		{
				return A_RefireDX("SemiAutoLol");
			
		}
		GLAN A 2 A_WeaponReady(WRF_NOFIRE|WRF_NOBOB);
		TNT1 A 0 A_AutoReloadMag(1,"Reload",true);
		Goto Ready;
	SemiAutoLol:
		GLAN A 1;
		TNT1 A 0 A_RefireDX("SemiAutoLol");
		TNT1 A 0 A_AutoReloadMag(1,"Reload",true);
		Goto Ready;
	NoAmmo:
		TNT1 A 0 A_Dryfire(force:true);
		Goto Ready;
	ReloadSmoke:
		SSGS MNOPQR 1;
		stop;
	DoReload:
		TNT1 A 0 A_JumpIfInventory("PowerSpeed2",1,"ReloadHaste");
		GLR1 ABCDEFGGGG 1;
		TNT1 A 0 A_StartSound("foley/GLDownwardsToOpen",10);
		GLR1 FHIJK 1;
		GLR1 L 1 A_Overlay(2,"ReloadSmoke");
		TNT1 A 0
		{
			A_FireProjectile(invoker.chaosGrenades ? "GrenadeCasingSpawner2" : "GrenadeCasingSpawner",0,0,-4, -14);
			A_StartSound("foley/GLEjectShell",11);
			A_StartSound("Weapons/GrenadeOpen");
		}
		GLR1 MN 1 A_FireProjectile("SmokeSpawner",0,0,0,-1);
		GLR1 O 1 A_FireProjectile("SmokeSpawner",0,0,0,2);
		GLR1 PP 1 A_FireProjectile("SmokeSpawner",0,0,0,3);
		GLR4 A 0 A_JumpIf(invoker.chaosGrenades, 2);
		GLR1 A 0;
		"####" QRSTUU 1;
		"####" W 1 {A_ReloadMag(); A_StartSound("Weapons/GrenadeLoad");}
		GLR1 XYZ 1;
		GLR2 A 1 A_GiveInventory("QuickSwitchSSG",1);
		TNT1 A 2 A_WeaponReady(WRF_NOFIRE);
		TNT1 A 0 A_StartSound("foley/GLUpwardsToClose",10);
		GLSA E 1 A_TakeInventory("QuickSwitchSSG",1);
		TNT1 A 0 A_StartSound("Weapons/GrenadeClose");
		GLSA EDCB 1 A_WeaponReady(WRF_NOFIRE);
		GLR3 M 1 A_WeaponReady(WRF_NOFIRE);
		Goto StrapIdle;
	ReloadHaste:
		GLR1 ACEGG 1;
		TNT1 A 0 A_StartSound("foley/GLDownwardsToOpen",10);
		GLR1 FIK 1;
		GLR1 L 1 A_Overlay(2,"ReloadSmoke");
		TNT1 A 0
		{
			A_FireProjectile(invoker.chaosGrenades ? "GrenadeCasingSpawner2" : "GrenadeCasingSpawner",0,0,-4, -14);
			A_StartSound("foley/GLEjectShell",11);
			A_StartSound("Weapons/GrenadeOpen");
		}
		GLR1 N 1 A_FireProjectile("SmokeSpawner",0,0,0,-1);
		GLR1 O 1 A_FireProjectile("SmokeSpawner",0,0,0,2);
		GLR1 P 1 A_FireProjectile("SmokeSpawner",0,0,0,3);
		GLR4 A 0 A_JumpIf(invoker.chaosGrenades, 2);
		GLR1 A 0;
		"####" RTU 1;
		"####" W 1 {A_ReloadMag(0,false,true); A_StartSound("Weapons/GrenadeLoad");}
		GLR1 Y 1;
		GLR2 A 1 A_GiveInventory("QuickSwitchSSG",1);
		TNT1 A 1 A_WeaponReady(WRF_NOFIRE);
		TNT1 A 0 A_StartSound("foley/GLUpwardsToClose",10);
		GLSA E 1 A_TakeInventory("QuickSwitchSSG",1);
		TNT1 A 0 A_StartSound("Weapons/GrenadeClose");
		GLSA DB 1 A_WeaponReady(WRF_NOFIRE);
		GLR3 M 1 A_WeaponReady(WRF_NOFIRE);
		Goto StrapIdle;
	SpecialAction:
		TNT1 A 0 A_JumpIfInventory("PowerSpeed2",1,"SpecialActionHaste");
		GLR1 ABCDEFGGGG 1;
		TNT1 A 0 A_StartSound("foley/GLDownwardsToOpen",10);
		GLR1 FHIJKL 1;
		TNT1 A 0 A_StartSound("Weapons/GrenadeOpen");
		GLR1 MNOPP 1;
		GLR1 A 0 A_jumpif(invoker.chaosGrenades, 2);
		GLR4 A 0;
		"####" QRSTUU 1;
		"####" W 1
		{
			if(invoker.chaosGrenades)
			{
				ChangeAmmoIcon1("ROCKA0");
				invoker.chaosGrenades = 0;
				A_Print("\cgHigh Explosive Grenades",2);
			}
			else
			{
				ChangeAmmoIcon1("ROCKE0");
				invoker.chaosGrenades = 1;
				A_Print("\cdChaos Field Grenades",2);
			}
			A_StartSound("Weapons/GrenadeLoad");
		}
		GLR1 XYZ 1;
		GLR2 A 1;
		TNT1 A 2;
		TNT1 A 0 A_StartSound("foley/GLUpwardsToClose",10);
		GLSA E 1;
		TNT1 A 0 A_StartSound("Weapons/GrenadeClose");
		GLSA EDCB 1;
		GLR3 M 1;
		Goto StrapIdle;
	SpecialActionHaste:
		GLR1 ACEGG 1;
		TNT1 A 0 A_StartSound("foley/GLDownwardsToOpen",10);
		GLR1 FIK 1;
		TNT1 A 0 A_StartSound("Weapons/GrenadeOpen");
		GLR1 NOP 1;
		GLR1 A 0 A_jumpif(invoker.chaosGrenades, 2);
		GLR4 A 0;
		"####" RTU 1;
		"####" W 1
		{
			if(invoker.chaosGrenades)
			{
				ChangeAmmoIcon1("ROCKA0");
				invoker.chaosGrenades = 0;
				A_Print("\cgHigh Explosive Grenades",2);
			}
			else
			{
				ChangeAmmoIcon1("ROCKE0");
				invoker.chaosGrenades = 1;
				A_Print("\cdChaos Field Grenades",2);
			}
			A_StartSound("Weapons/GrenadeLoad");
		}
		GLR1 Y 1;
		GLR2 A 1;
		TNT1 A 1;
		TNT1 A 0 A_StartSound("foley/GLUpwardsToClose",10);
		GLSA E 1;
		TNT1 A 0 A_StartSound("Weapons/GrenadeClose");
		GLSA DB 1;
		GLR3 M 1;
		Goto StrapIdle;
	Fidget:
		GLR1 ABCDEFGGGG 1 A_WeaponReadyDX(0,false);
		TNT1 A 0 A_StartSound("foley/GLDownwardsToOpen",10);
		GLR1 FHIJK 1 A_WeaponReadyDX(0,false);
		GLR2 L 1 A_WeaponReadyDX(0,false);
		TNT1 A 0 A_StartSound("Weapons/GrenadeOpen");
		GLR2 MN 1 A_WeaponReadyDX(0,false);
		GLR2 O 1 A_WeaponReadyDX(0,false);
		GLR2 P 11 A_WeaponReadyDX(0,false);
	FidgetLoop:
		GLR2 P 1 A_WeaponReadyDX(0,false);
		TNT1 A 0 A_PressingReload("FidgetLoop");
		GLR2 QR 1 A_WeaponReadyDX(0,false);
		GLR2 S 1 A_WeaponReadyDX(0,false);
		TNT1 A 2 A_WeaponReadyDX(0,false);
		TNT1 A 0 A_StartSound("foley/GLUpwardsToClose",10);
		GLSA E 1 A_WeaponReadyDX(0,false);
		TNT1 A 0 A_StartSound("Weapons/GrenadeClose");
		GLSA EDCB 1 A_WeaponReadyDX(0,false);
		GLR3 M 1 A_WeaponReadyDX(0,false);
		Goto StrapIdle;
	Spawn:
		GLAP A -1;
		Stop;
	/*FireSticky:
		TNT1 A 0 A_TakeAmmo("GLAmmo", 1)
		TNT1 A 0 A_FireProjectile("BlueFlareSpawn",-5,0,0,0)
		TNT1 AAAAA 0 BRIGHT A_FireProjectile("ShotgunParticles", random(-12,12), 0, -1, 0, 0, random(-9,9))
		TNT1 AA 0 BRIGHT A_FireProjectile("ShotgunParticles2", random(-12,12), 0, -1, 0, 0, random(-9,9))
		TNT1 A 0 A_StartSound("weapons/firegrenade", 1)
		TNT1 A 0 A_FireProjectile("GrenadeMissileBreaksGlass", 0, 0, 0, 0)
		TNT1 A 0 A_ZoomFactor(0.98)
	//	TNT1 A 0 A_Recoil(2*cos(pitch))
	SHTZ A 0 
		{
		A_Recoil(1*cos(pitch));
			if(momZ != 0)
			{
			ThrustThingZ(0,pitch/3,0,1);
			}
		else
			{
			ThrustThingZ(0,pitch/4,0,1);
			}
		}
		GL2F A 1 BRIGHT 
		{
		A_ZoomFactor(1.0);
		//A_print("BEQUEATH");
		//A_FireProjectile("ShortGrenade", 0, 0, 0, 0);
	A_FireProjectile("leadburster", 0, 0, 0, 0);
		A_SetPitch(pitch-10, SPF_INTERPOLATE);
		}
		GL2F F 1 BRIGHT A_SetPitch(2 + pitch, SPF_INTERPOLATE)
		GLAF EDCB 1 A_SetPitch(2 + pitch, SPF_INTERPOLATE)
		GLR3 C 1
		GLAN A 2 A_jumpIfInventory("PowerSPeed2",1,"ready")
		Goto NoAmmo2
		
	AltFire:
		TNT1 A 0
		TNT1 A 0 A_CheckIfAmmo("GLAmmo")
		TNT1 A 0
		TNT1 A 0 A_TakeAmmo("GLAmmo", 1)
		//TNT1 A 0 A_jumpif(Countinv("StickyGrenadeSelected")==1, "altfiresticky")
		TNT1 A 0 A_FireProjectile("RedFlareSpawn",-5,0,0,0)
		TNT1 AAAAA 0 BRIGHT A_FireProjectile("ShotgunParticles", random(-12,12), 0, -1, 0, 0, random(-9,9))
		TNT1 AA 0 BRIGHT A_FireProjectile("ShotgunParticles2", random(-12,12), 0, -1, 0, 0, random(-9,9))
		TNT1 A 0 A_StartSound("weapons/firegrenade", 1)
		TNT1 A 0 A_FireProjectile("GrenadeMissileBreaksGlass", 0, 0, 0, 0)
		TNT1 A 0 A_ZoomFactor(0.98)
	//	TNT1 A 0 A_Recoil(2*cos(pitch))
	SHTZ A 0 
		{
		A_Recoil(1*cos(pitch));
			if(momZ != 0)
			{
			ThrustThingZ(0,pitch/3,0,1);
			}
		else
			{
			ThrustThingZ(0,pitch/4,0,1);
			}
		}
		GLAF A 1 BRIGHT 
		TNT1 A 0 A_ZoomFactor(1.0)
		TNT1 A 0 
		{
		If(Countinv("StickyGrenadeSelected")==1)
		{
			A_FireProjectile("FireGrenade2", 0, 0, 0, 0);
		}
		Else
		{
		A_FireProjectile("GrenadeMissile", 0, 1, 0, 0);
		}
		}
		TNT1 A 0 A_SetPitch(pitch-10, SPF_INTERPOLATE)
		GLAF F 1 BRIGHT A_SetPitch(2 + pitch, SPF_INTERPOLATE)
		GLAF EDCB 1 A_SetPitch(2 + pitch, SPF_INTERPOLATE)
		GLR3 C 1
		GLAN A 2 A_jumpIfInventory("PowerSPeed2",1,"ready")
		Goto NoAmmo2
		
		AltFireSticky:
		TNT1 A 0 A_FireProjectile("BlueFlareSpawn",-5,0,0,0)
		TNT1 AAAAA 0 BRIGHT A_FireProjectile("ShotgunParticles", random(-12,12), 0, -1, 0, 0, random(-9,9))
		TNT1 AA 0 BRIGHT A_FireProjectile("ShotgunParticles2", random(-12,12), 0, -1, 0, 0, random(-9,9))
		TNT1 A 0 A_StartSound("weapons/firegrenade", 1)
		TNT1 A 0 A_FireProjectile("GrenadeMissileBreaksGlass", 0, 0, 0, 0)
		TNT1 A 0 A_ZoomFactor(0.98)
	//	TNT1 A 0 A_Recoil(2*cos(pitch))
	SHTZ A 0 
		{
		A_Recoil(1*cos(pitch));
			if(momZ != 0)
			{
			ThrustThingZ(0,pitch/3,0,1);
			}
		else
			{
			ThrustThingZ(0,pitch/4,0,1);
			}
		}
		GL2F A 1 BRIGHT 
		TNT1 A 0 A_ZoomFactor(1.0)
		TNT1 A 0 A_FireProjectile("StickyGrenadeBouncy", 0, 1, 0, 0)
		TNT1 A 0 A_SetPitch(pitch-10, SPF_INTERPOLATE)
		GL2F F 1 BRIGHT A_SetPitch(2 + pitch, SPF_INTERPOLATE)
		GLAF EDCB 1 A_SetPitch(2 + pitch, SPF_INTERPOLATE)
		GLR3 C 1
		GLAN A 2 A_jumpIfInventory("PowerSPeed2",1,"ready")
		Goto NoAmmo2
		*/
	}
}

Class GrenadeDetonates : Actor
{
	Default
	{
	Radius 4;
	Height 4;
	Speed 50;
	Damagefunction 60;
	+MISSILE;
	Gravity 0.7;
	+SKYEXPLODE;
	+BOUNCEONFLOORS;
	+BOUNCEONWALLS;
	+BOUNCEONCEILINGS;
	+bounceonactors;
	+EXPLODEONWATER;
	+THRUSPECIES;
	+BOUNCEAUTOOFFFLOORONLY;
	+usebouncestate;
	Species "Marines";
	DamageType "Kick";
	BounceFactor 0.5;
	WallBounceFactor 0.35;
	BounceSound "Weapons/GrenadeBounce";
	DeathSound "Weapons/GrenadeBounce";
	Decal "Scorch";
	Obituary "$OB_MPROCKET";
	Scale 0.7;
	}
	States
	{
	Spawn:
		GBPJ AAABBBCCC 1 
		{
			A_SpawnProjectile ("RocketSmokeTrail52", 2, 0, random (70, 110), 2, random (0, 360));
			//A_SpawnItemEX("RocketFlare");
		}
		Goto bounce;
	Spawn2:
		GBPJ AAABBBCCCDDDEEEFFFGGGHHH 1 
		{
			A_SpawnItemEX("GrenadeFlare");
			A_SpawnProjectile ("RocketSmokeTrail52", 2, 0, random (70, 110), 2, random (0, 360));
			If(target && target.player && target.player.cmd.buttons & BT_ATTACK)
			{
				Return resolvestate(null);
			}
			Else
			{
				Return resolvestate("Explode");
			}
		}
		Loop;
	Bounce:
		TNT1 A 0
		{
			If(target && target.player && target.player.cmd.buttons & BT_ATTACK)
			{
				Return resolvestate("spawn2");
			}
			Else
			{
				Return resolvestate("Explode");
			}
		}
	Death:
	Xdeath:

		GBPJ AAAA 1 
		{
			A_SpawnItemEX("GrenadeFlare");
			A_SpawnProjectile ("RocketSmokeTrail52", 2, 0, random (70, 110), 2, random (0, 360));
			If(target && target.player && target.player.cmd.buttons & BT_ATTACK)
			{
				Return resolvestate(null);
			}
			Else
			{
				Return resolvestate("Explode");
			}
		
		}
		Loop;
	
	Explode:
		TNT1 A 0 A_stopsound(7);
		TNT1 A 0 A_StartSound("Explosion", 1);
		EXPL A 0 Radius_Quake (8, 8, 0, 128, 0);//(intensity, duration, damrad, tremrad, tid)
		TNT1 A 0 A_SpawnItemEx ("GrenadeExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0);
	   TNT1 A 0 A_spawnitemex("ricochetexplosion");
		TNT1 AAAAAAAAAA 0 A_spawnProjectile ("BDExplosionparticlesBig", 0, 0, random (0, 360), 2, random (0, 360));
		TNT1 AAAAAAA 0 A_SpawnProjectile ("BDExplosionparticles2", 0, 0, random (0, 360), 2, random (0, -90));
	   	TNT1 AAAA 0 A_spawnProjectile ("SmallExplosionFlames", 0, 0, random (0, 360), 2, random (0, 360))  ;
		TNT1 AAAAAAA 0 A_SpawnProjectile ("ExplosionFlames", 0, 0, random (0, 360), 2, random (0, 360));
		TNT1 AAAAAAAAAAAAAA 0 A_SpawnProjectile ("ExplosionParticleHeavy", 0, 0, random (0, 360), 2, random (0, -180));
		TNT1 AAAAAA 0 A_SpawnProjectile ("ExplosionParticleHeavy", 0, 0, random (0, 180), 2, random (0, 180));
		TNT1 A 0 A_StartSound("FAREXPL", 3);
	//	TNT1 AAAAAAAAAA 4 A_CustomMissile ("ExplosionSmoke", 1, 0, random (0, 360), 2, random (50, 130))
		TNT1 A 0 A_SpawnProjectile ("ExplosionSmoke", 1, 0, random (0, 360), 2, random (-50, -130));
		stop;
	}
}

CLASS StupidGrenade : GrenadeDetonates
{

	States
	{
		Spawn:
		GBPJ AAABBBCCC 1 
		{
			A_SpawnProjectile ("RocketSmokeTrail52", 2, 0, random (70, 110), 2, random (0, 360));
			//A_SpawnItemEX("RocketFlare");
		}
		Goto bounce;
		Spawn2:
		GBPJ AAABBBCCCDDDEEEFFFGGGHHH 1 
		{
			A_SpawnItemEX("GrenadeFlareGreen");
			A_SpawnProjectile ("RocketSmokeTrail52", 2, 0, random (70, 110), 2, random (0, 360));
			If(target && target.player && target.player.cmd.buttons & BT_ATTACK)
			{
				Return resolvestate(null);
			}
			Else
			{
				Return resolvestate("Explode");
			}
		}
		Loop;
		Death:
	Xdeath:

		GBPJ AAAA 1 
		{
			A_SpawnItemEX("GrenadeFlareGreen");
			A_SpawnProjectile ("RocketSmokeTrail52", 2, 0, random (70, 110), 2, random (0, 360));
			If(target && target.player && target.player.cmd.buttons & BT_ATTACK)
			{
				Return resolvestate(null);
			}
			Else
			{
				Return resolvestate("Explode");
			}
		
		}
		Loop;
		
		Explode:
		TNT1 A 0 A_startsound("STUPGREN");
		BG2G A 0 Bright A_SpawnItem("GreenShockWave",0,0,0);
			EXPL AAAAAAAAAAAAA 0 A_CustomMissile ("BFGDeathParticleSuperFast", 0, 0, random (0, 360), 2, random (0, 360));
			EXPL AAAAAAAAAAAAAA 0 A_CustomMissile ("BFGDeathParticleFast", 0, 0, random (0, 360), 2, random (0, 360));
			EXPL AAAA 0 A_CustomMissile ("BFGBIGFOG", 0, 0, random (0, 360), 2, random (0, 360));
			//TNT1 AAAAAAA 0 A_CustomMissile ("GreenExplosionFire", 2, 0, random (0, 360), 2, random (0, 360));
			//EXPL AA 0 A_CustomMissile ("BigNeoSmoke", 0, 0, random (0, 360), 2, random (0, 360));
			TNT1 A 0 A_RadiusGive("ChaosInfighter",356,RGF_MONSTERS,1);
			TNT1 A 0 A_RadiusGive("ChaosParticles",356,RGF_MONSTERS,1);
			Stop;
	}
}


//Thanks drpyspy!

Class ChaosInfighter : CustomInventory
{
	Default
	{
		Inventory.MaxAmount 0;
		+INVENTORY.AUTOACTIVATE
	}
	States
	{
		Use:
		TNT1 A 0;
		TNT1 A 1
		{
			//Console.Printf("Chaos given to "..GetClassName());
			bool isNotPlayer = !(target is "BDPPlayerPawn");
			/*if(target!=null)
			{
				//Console.Printf("His target is "..target.GetClassName().." ("..(target is "Delta_PlayerPawn")..")");
			}*/
			if(target!=null&&isNotPlayer)
			{
				//Console.Printf(GetClassName().." already has a target, whomst is "..target.GetClassName());
				return;
			}
			else
			{
				//Console.Printf("Lets look...");
				ThinkerIterator MonsterFinder = ThinkerIterator.Create("Actor");
				Actor mo;
				while (mo = Actor(MonsterFinder.Next()))
				{
					if(mo!=self&&mo.health>0&&mo.bIsMonster&&CheckSight(mo))
					{
						if((target!=null&&isNotPlayer)&&Distance3D(mo)<Distance3D(target))
						{
							target=mo;
						}
						else if (target==null||!isNotPlayer)
						{
							target=mo;
						}
					}
				}
			}
			
		}
		
		Stop;
	}
}
Class ChaosParticles : Inventory
{
	int dur;
	int duration;
	Default 
	{
		+INVENTORY.UNDROPPABLE;
		+INVENTORY.UNTOSSABLE;
		inventory.maxamount 1;
	}
	Override void postbeginplay()
		{
			Duration = 35;
		}
	Override void Tick() {}
	Override void DoEffect() 
	{
		super.DoEffect();
		
		
		

	
		float rdepth;
			float rwidth;
			float rheight;
			rdepth = frandom(-1,1);
			rwidth = frandom(-1,1);
			rheight = frandom(0.01,0.70);
			
			
			
			If (owner)
			{
				owner.A_SpawnItemEx(
				"StupidParticle",
							xofs:(owner.radius*rdepth),
				yofs:(owner.radius*rdepth),
				zofs:(owner.height*rheight),
				xvel:(random(-1,1)),
				yvel:(random(-1,1)),
				zvel:(random(3,5))
				
				);
			}
			if (dur < duration)
				dur++;
			else {
				DepleteOrDestroy();
				return;
			}
	}
}
